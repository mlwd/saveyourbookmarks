<!DOCTYPE HTML>
<html>
<style>
input.text-input {
  width: 300px;
}
</style>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
  function saveBookmark() {
    const titleInput = document.getElementById('bookmark-title');
    const urlInput = document.getElementById('bookmark-url');
    const messageDiv = document.getElementById('message-div');
    axios.post('/savebookmark', {'title': titleInput.value, 'url': urlInput.value})
      .then((response) => {
        const message = response.data.message;
        if (message) {
          messageDiv.innerHTML = message;
        }
        titleInput.value = '';
        urlInput.value = '';
        loadBookmark();
      })
      .catch((err) => console.log(err));
  }

  function loadBookmark() {
    axios.get('/loadbookmark').then((response) => {
      const table = document.getElementById('bookmark-table');
      table.innerHTML = '';
      for (let row of response.data) {
        const tr = document.createElement('tr');

        const tdTitle = document.createElement('td');
        tdTitle.innerHTML = row.title;
        tr.appendChild(tdTitle);

        const tdURL = document.createElement('td');
        const aURL = document.createElement('a');
        aURL.href = row.url;
        aURL.innerHTML = row.url;
        tdURL.appendChild(aURL);
        tr.appendChild(tdURL);

        const tdDelete = document.createElement('td');
        tdDelete.innerHTML = 'Delete';
        tdDelete.setAttribute('onclick', 'deleteBookmarkWhere(\'' + row.url + '\')');
        tr.appendChild(tdDelete);

        table.appendChild(tr);
      }
    });
  }

  function deleteBookmark() {
    axios.post('/deletebookmark')
      .then(loadBookmark)
      .catch((err) => {console.log(err);});
  }

  function deleteBookmarkWhere(url) {
    console.log("Delete where url=" + url);
    axios.post('/deletebookmarkwhere', {'url': url})
      .then(loadBookmark)
      .catch((err) => {console.log(err);});
  }
</script>
<h4>Save your bookmarks!</h4>
<label>Title</label><br>
<input type='text' id='bookmark-title' class='text-input'><br>
<label>URL</label><br>
<input type='text' id='bookmark-url' class='text-input'><br>
<input type='submit' onClick='saveBookmark()' value ='Save'>
<input type='submit' onClick='loadBookmark()' value ='Load'>
<input type='submit' onClick='clearBookmark()' value ='Clear'>
<span id='message-div'></span>
<table id='bookmark-table'></table>
</html>
